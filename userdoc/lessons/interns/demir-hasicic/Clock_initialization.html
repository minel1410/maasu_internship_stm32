<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.1.3.4. Clock Initialization &mdash; Maasu Internship 4 1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/common.css?v=bd9ab754" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/layouts.css?v=448c382f" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/styles.css?v=6c8eb985" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/modern.css?v=ffa536d2" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=29a6c3e3"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
        <script src="../../../../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=f783d6a5"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="4.1.3.5. USART" href="USART.html" />
    <link rel="prev" title="4.1.3.3. GPIO" href="GPIO.html" />
<link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Maasu Internship 4
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentals/fundamentals.html">2. Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../environment_setup/environment_setup.html">3. Development Environment Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../lessons.html">4. Lessons</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../lessons.html">4.1. Lessons written by each intern</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adna-njuhovic/lessons.html">4.1.1. Lessons by Adna Njuhović</a></li>
<li class="toctree-l3"><a class="reference internal" href="../anesa-lakovic/lessons.html">4.1.2. Lessons by Anesa Laković</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lessons.html">4.1.3. Lessons by Demir Hasičić</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="vmodel.html">4.1.3.1. V-model</a></li>
<li class="toctree-l4"><a class="reference internal" href="stm32overview.html">4.1.3.2. STM32F411</a></li>
<li class="toctree-l4"><a class="reference internal" href="GPIO.html">4.1.3.3. GPIO</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">4.1.3.4. Clock Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="USART.html">4.1.3.5. USART</a></li>
<li class="toctree-l4"><a class="reference internal" href="Timer.html">4.1.3.6. Timer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../emina-mesic/lessons.html">4.1.4. Lessons by Emina Mešić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lamija-fatic/lessons.html">4.1.5. Lessons by Lamija Fatić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../muhibija-kavazovic/lessons.html">4.1.6. Lessons by Muhibija Kavazović</a></li>
<li class="toctree-l3"><a class="reference internal" href="../semin-murtic/lessons.html">4.1.7. Lessons by Semin Murtić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tarik-sinanovic/lessons.html">4.1.8. Lessons by Tarik Sinanović</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../requirements/requirements.html">5. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faqs/faqs.html">6. Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/glossary.html">7. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources/resources.html">8. Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Maasu Internship 4</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../lessons.html"><span class="section-number">4. </span>Lessons</a></li>
          <li class="breadcrumb-item"><a href="../lessons.html"><span class="section-number">4.1. </span>Lessons written by each intern</a></li>
          <li class="breadcrumb-item"><a href="lessons.html"><span class="section-number">4.1.3. </span>Lessons by Demir Hasičić</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.1.3.4. </span>Clock Initialization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/userdoc/lessons/interns/demir-hasicic/Clock_initialization.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="clock-initialization">
<h1><span class="section-number">4.1.3.4. </span>Clock Initialization<a class="headerlink" href="#clock-initialization" title="Link to this heading"></a></h1>
<section id="introduction">
<h2><span class="section-number">4.1.3.4.1. </span>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Clock initialization is a crucial step in configuring the STM32F411 microcontroller to ensure accurate and efficient operation. Proper setup of clocks affects the overall performance, timing precision, and power efficiency of the microcontroller. This lesson will cover essential terms, key registers, the role of the PLL, and a practical example to configure a 100 MHz system clock.</p>
</section>
<section id="key-concepts-and-components">
<h2><span class="section-number">4.1.3.4.2. </span>Key Concepts and Components<a class="headerlink" href="#key-concepts-and-components" title="Link to this heading"></a></h2>
<p><strong>RCC (Reset and Clock Control)</strong></p>
<p>The RCC module is responsible for managing the clock sources and reset circuitry within the STM32F411 microcontroller. It provides configuration options to select system clocks, enable/disable peripheral clocks, and control the frequency of each clock domain.</p>
<p><strong>Clock Sources</strong></p>
<ol class="arabic simple">
<li><p><strong>High-Speed Internal (HSI)</strong>:</p>
<ul class="simple">
<li><p>Frequency: 16 MHz.</p></li>
<li><p>Usage: Fast startup, suitable for basic timing functions.</p></li>
<li><p>Less precise than external sources but convenient for applications without strict timing requirements.</p></li>
</ul>
</li>
<li><p><strong>High-Speed External (HSE)</strong>:</p>
<ul class="simple">
<li><p>Frequency: Typically between 8 MHz and 25 MHz.</p></li>
<li><p>Usage: Often paired with the PLL for high-accuracy applications like communication.</p></li>
<li><p>Provides stable and precise timing, ideal for applications demanding accuracy.</p></li>
</ul>
</li>
<li><p><strong>Low-Speed Internal (LSI)</strong>:</p>
<ul class="simple">
<li><p>Frequency: 32 kHz.</p></li>
<li><p>Usage: Primarily as a backup for low-power tasks such as real-time clocks (RTC).</p></li>
<li><p>Consumes low power, suitable for energy-efficient designs.</p></li>
</ul>
</li>
<li><p><strong>Low-Speed External (LSE)</strong>:</p>
<ul class="simple">
<li><p>Frequency: 32.768 kHz.</p></li>
<li><p>Usage: Used for RTC and applications requiring synchronized, stable timing.</p></li>
<li><p>Provides high accuracy and long-term stability, ideal for applications needing precise timing over extended periods.</p></li>
</ul>
</li>
</ol>
<p><strong>PLL (Phase-Locked Loop)</strong></p>
<p>The PLL allows the STM32F411 to achieve higher frequencies by multiplying the input clock. It is configured by setting multipliers and dividers to produce the desired system clock (SYSCLK).</p>
</section>
<section id="key-registers-and-configurations">
<h2><span class="section-number">4.1.3.4.3. </span>Key Registers and Configurations<a class="headerlink" href="#key-registers-and-configurations" title="Link to this heading"></a></h2>
<p><strong>Control Register (CR)</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Manages the activation of clock sources and monitors their readiness.</p></li>
<li><p>Key bits:</p>
<ul>
<li><p>HSEON: Enables the HSE oscillator.</p></li>
<li><p>HSERDY: Indicates the readiness of the HSE oscillator.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p><strong>PLL Configuration Register (PLLCFGR)</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Configures the PLL’s multiplication and division factors.</p></li>
<li><p>Key fields:</p>
<ul>
<li><p>PLLM: Divides the HSE input clock.</p></li>
<li><p>PLLN: Multiplier to achieve the VCO (Voltage-Controlled Oscillator) frequency.</p></li>
<li><p>PLLP: Divider for the PLL output, configuring the final SYSCLK frequency.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p><strong>Clock Configuration Register (RCC_CFGR)</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Controls system clock selection and prescalers for AHB, APB1, and APB2 buses.</p></li>
<li><p>Key fields:</p>
<ul>
<li><p>SW (System Clock Switch): Selects the system clock source.</p></li>
<li><p>SWS (System Clock Switch Status): Indicates the currently active system clock source.</p></li>
<li><p>HPRE (AHB Prescaler): Configures the division factor for the AHB clock.</p></li>
<li><p>PPRE1 (APB1 Low-Speed Prescaler): Controls the APB1 clock divider.</p></li>
<li><p>PPRE2 (APB2 High-Speed Prescaler): Controls the APB2 clock divider.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p><strong>FLASH Access Control Register (FLASH_ACR)</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Configures flash memory latency, allowing operation at high system clock speeds.</p></li>
<li><p>Key field:</p>
<ul>
<li><p>FLASH_ACR_LATENCY: Sets memory wait states; for example, 3 wait states are needed at clock speeds around 100 MHz.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
<p><strong>Power Control Register (PWR_CR)</strong>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Key field:</p>
<ul>
<li><p>VOS (Voltage Scaling): Configures voltage levels to optimize power and performance based on the application needs.</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</section>
<section id="systemcoreclockupdate">
<h2><span class="section-number">4.1.3.4.4. </span>SystemCoreClockUpdate()<a class="headerlink" href="#systemcoreclockupdate" title="Link to this heading"></a></h2>
<p>The SystemCoreClockUpdate() function is part of the CMSIS (Cortex Microcontroller Software Interface Standard) library, responsible for keeping the SystemCoreClock variable in sync with the actual clock settings of the microcontroller.</p>
<ul class="simple">
<li><p>Purpose: Updates the SystemCoreClock variable to reflect the current system clock frequency, ensuring that timing functions and configurations dependent on the clock frequency are accurate.</p></li>
<li><p>How It Works: The function reads the RCC register settings (such as the active clock source, prescalers, and PLL configuration) and calculates the actual system clock frequency.</p></li>
<li><p>Why It’s Important: Proper timing and peripheral configuration require an accurate system clock value. By running SystemCoreClockUpdate(), the software always has the correct system frequency, which is crucial for tasks like configuring delays, timers, and peripheral baud rates.</p></li>
</ul>
</section>
<section id="steps-to-configure-the-frequency-of-100-mhz-from-a-25-mhz-oscillator-frequency">
<h2><span class="section-number">4.1.3.4.5. </span>Steps to Configure the Frequency of 100 MHz from a 25 MHz Oscillator Frequency<a class="headerlink" href="#steps-to-configure-the-frequency-of-100-mhz-from-a-25-mhz-oscillator-frequency" title="Link to this heading"></a></h2>
<p>To configure the STM32F411 microcontroller to achieve a 100 MHz system clock (SYSCLK) from a 25 MHz High-Speed External (HSE) oscillator, we need to set up the PLL (Phase-Locked Loop) with specific values for PLLM, PLLN, and PLLP. Here’s how:</p>
<p>To achieve 100 MHz, we need to configure the following PLL parameters:</p>
<ol class="arabic simple">
<li><p>PLLM = 25: Divides the 25 MHz HSE input down to 1 MHz.</p></li>
<li><p>PLLN = 200: Multiplies the 1 MHz VCO input up to 200 MHz.</p></li>
<li><p>PLLP = 2: Divides the 200 MHz VCO output down to 100 MHz.</p></li>
</ol>
</section>
<section id="conclusion">
<h2><span class="section-number">4.1.3.4.6. </span>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading"></a></h2>
<p>Clock initialization in the STM32F411 microcontroller is a fundamental process that directly impacts system performance, timing accuracy, and power efficiency. By carefully configuring the clock sources, such as the High-Speed External (HSE) and High-Speed Internal (HSI) oscillators, and setting the Phase-Locked Loop (PLL) parameters, we can achieve the desired operating frequency.</p>
<p>Key registers like the Control Register (CR), PLL Configuration Register (PLLCFGR), and Clock Configuration Register (RCC_CFGR) provide the flexibility to manage and fine-tune the clock settings, ensuring that each component of the microcontroller functions optimally.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GPIO.html" class="btn btn-neutral float-left" title="4.1.3.3. GPIO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="USART.html" class="btn btn-neutral float-right" title="4.1.3.5. USART" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Maasu BH d.o.o..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>