<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4.1.7.5. USART &mdash; Maasu Internship 4 1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-data-viewer/jsonview.bundle.css?v=f6ef2277" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/libs/html/datatables.min.css?v=4b4fd840" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/common.css?v=bd9ab754" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/layouts.css?v=448c382f" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/styles.css?v=6c8eb985" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-needs/modern.css?v=ffa536d2" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=29a6c3e3"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../../_static/sphinx-data-viewer/jsonview.bundle.js?v=18cd53c5"></script>
        <script src="../../../../_static/sphinx-data-viewer/jsonview_loader.js?v=f7ff7e7d"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/datatables.min.js?v=8a4aee21"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/datatables_loader.js?v=a2cae175"></script>
        <script src="../../../../_static/sphinx-needs/libs/html/sphinx_needs_collapse.js?v=f783d6a5"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="4.1.7.6. Timer" href="Timer.html" />
    <link rel="prev" title="4.1.7.4. Clock" href="Clock.html" />
<link href="../../../../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Maasu Internship 4
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../introduction/introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentals/fundamentals.html">2. Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../environment_setup/environment_setup.html">3. Development Environment Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../lessons.html">4. Lessons</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../lessons.html">4.1. Lessons written by each intern</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../adna-njuhovic/lessons.html">4.1.1. Lessons by Adna Njuhović</a></li>
<li class="toctree-l3"><a class="reference internal" href="../anesa-lakovic/lessons.html">4.1.2. Lessons by Anesa Laković</a></li>
<li class="toctree-l3"><a class="reference internal" href="../demir-hasicic/lessons.html">4.1.3. Lessons by Demir Hasičić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../emina-mesic/lessons.html">4.1.4. Lessons by Emina Mešić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lamija-fatic/lessons.html">4.1.5. Lessons by Lamija Fatić</a></li>
<li class="toctree-l3"><a class="reference internal" href="../muhibija-kavazovic/lessons.html">4.1.6. Lessons by Muhibija Kavazović</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lessons.html">4.1.7. Lessons by Semin Murtić</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="V-Model.html">4.1.7.1. V-Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="STM32F411.html">4.1.7.2. STM32F411</a></li>
<li class="toctree-l4"><a class="reference internal" href="GPIO.html">4.1.7.3. GPIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="Clock.html">4.1.7.4. Clock</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">4.1.7.5. USART</a></li>
<li class="toctree-l4"><a class="reference internal" href="Timer.html">4.1.7.6. Timer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tarik-sinanovic/lessons.html">4.1.8. Lessons by Tarik Sinanović</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../requirements/requirements.html">5. Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faqs/faqs.html">6. Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/glossary.html">7. Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../resources/resources.html">8. Resources</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Maasu Internship 4</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../lessons.html"><span class="section-number">4. </span>Lessons</a></li>
          <li class="breadcrumb-item"><a href="../lessons.html"><span class="section-number">4.1. </span>Lessons written by each intern</a></li>
          <li class="breadcrumb-item"><a href="lessons.html"><span class="section-number">4.1.7. </span>Lessons by Semin Murtić</a></li>
      <li class="breadcrumb-item active"><span class="section-number">4.1.7.5. </span>USART</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/userdoc/lessons/interns/semin-murtic/USART.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usart">
<span id="id1"></span><h1><span class="section-number">4.1.7.5. </span>USART<a class="headerlink" href="#usart" title="Link to this heading"></a></h1>
<section id="overview">
<h2><span class="section-number">4.1.7.5.1. </span>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p><strong>USART</strong> is a peripheral module in microcontrollers that enables communication between devices via a serial protocol. It is used for data transmission between devices such as microcontrollers, computers, sensors, and other modules. USART is used for serial communication between two devices, where reliable and continuous data exchange is required.</p>
</section>
<section id="usart-functional-description">
<h2><span class="section-number">4.1.7.5.2. </span>USART – Functional Description<a class="headerlink" href="#usart-functional-description" title="Link to this heading"></a></h2>
<p>The functionality of the USART includes modes of operation such as data transmission and reception, controlling transmission speed, operating modes (synchronous or asynchronous), and additional flow control and error detection features.</p>
<ul class="simple">
<li><p><strong>Transmitter</strong>: Sending data.</p></li>
<li><p><strong>Receiver</strong>: Receiving data.</p></li>
<li><p><strong>Control Registers</strong>: Configures parameters such as baud rate, operating mode, parity, etc.</p></li>
</ul>
</section>
<section id="usart-key-features">
<h2><span class="section-number">4.1.7.5.3. </span>USART – Key Features<a class="headerlink" href="#usart-key-features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Support for asynchronous and synchronous operation modes.</p></li>
<li><p>Configurable baud rate for flexible communication speed.</p></li>
<li><p>Configurable data size (8-bit, 9-bit).</p></li>
<li><p>Parity control (even, odd, no parity) for error detection.</p></li>
<li><p>Support for DMA (Direct Memory Access), speeding up data transmission.</p></li>
<li><p>Single-wire Half-duplex: Uses one pin for both data transmission and reception.</p></li>
</ul>
</section>
<section id="usart-interfaces-on-stm32f411">
<h2><span class="section-number">4.1.7.5.4. </span>USART Interfaces on STM32F411<a class="headerlink" href="#usart-interfaces-on-stm32f411" title="Link to this heading"></a></h2>
<p>The STM32F411 microcontroller supports three USARTs:</p>
<ul class="simple">
<li><p><strong>USART1</strong>: Connected to the APB2 bus. Uses pins PA9 (TX) and PA10 (RX).</p></li>
<li><p><strong>USART2</strong>: Connected to the APB1 bus. Uses pins PA2 (TX) and PA3 (RX).</p></li>
<li><p><strong>USART6</strong>: Connected to the APB2. Uses pins PC6 (TX) and PC7 (RX).</p></li>
</ul>
</section>
<section id="usart-modes">
<h2><span class="section-number">4.1.7.5.5. </span>USART Modes<a class="headerlink" href="#usart-modes" title="Link to this heading"></a></h2>
<section id="asynchronous-mode">
<h3><span class="section-number">4.1.7.5.5.1. </span><strong>Asynchronous Mode</strong>:<a class="headerlink" href="#asynchronous-mode" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>No common clock.</p></li>
<li><p>Start and stop bits are used to mark the beginning and end of a data packet.</p></li>
<li><p>Lower data rate: Since no common clock is required.</p></li>
<li><p>Asynchronous mode may be slower and less efficient, but easier to implement.</p></li>
<li><p>Commonly used in situations where simple and flexible communication with lower data flow is needed.</p></li>
</ul>
</section>
<section id="synchronous-mode">
<h3><span class="section-number">4.1.7.5.5.2. </span><strong>Synchronous Mode</strong>:<a class="headerlink" href="#synchronous-mode" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Uses a common clock between devices.</p></li>
<li><p>Both devices send and receive data based on the same clock, enabling faster and more efficient communication.</p></li>
<li><p>Suitable for applications requiring fast and stable communication.</p></li>
</ul>
</section>
</section>
<section id="usart-baud-rate">
<h2><span class="section-number">4.1.7.5.6. </span>USART Baud Rate<a class="headerlink" href="#usart-baud-rate" title="Link to this heading"></a></h2>
<p>The baud rate represents the speed of data transmission between devices and is measured in bits per second (bps). In USART, the baud rate can be adjusted using the <strong>BRR (Baud Rate Register)</strong>.</p>
<p><strong>Formula</strong>:</p>
<p>Baud Rate = fPCLK / (8 * (2 - OVER8) * USARTDIV)</p>
<p>Where:</p>
<ul class="simple">
<li><p><strong>fPCLK</strong>: Clock frequency.</p></li>
<li><p><strong>OVER8</strong>: Oversampling configuration.</p></li>
<li><p><strong>USARTDIV</strong>: Value in the BRR register.</p></li>
</ul>
<p>In USART, the baud rate setting ensures that the transmitting and receiving devices operate at the same speed to maintain reliable communication. The baud rate depends on the peripheral clock frequency (fPCLK) and the configuration of the USART peripheral. The oversampling factor (OVER8) can be adjusted to control the precision and speed of data transmission.</p>
<ul class="simple">
<li><p>With <strong>16x oversampling</strong> (default), the signal is more stable.</p></li>
<li><p>With <strong>8x oversampling</strong>, faster data transmission is allowed, but with a potential loss in accuracy.</p></li>
</ul>
</section>
<section id="usart-oversampling">
<h2><span class="section-number">4.1.7.5.7. </span>USART Oversampling<a class="headerlink" href="#usart-oversampling" title="Link to this heading"></a></h2>
<p>Oversampling is used to improve accuracy in asynchronous mode. It can be set to <strong>8x</strong> or <strong>16x</strong>, where:</p>
<ul class="simple">
<li><p><strong>16x oversampling</strong> is the standard mode, providing a more stable signal.</p></li>
<li><p><strong>8x oversampling</strong> allows faster data transfer but may reduce accuracy.</p></li>
</ul>
<p>Oversampling is set in the <strong>CR1 (Control Register 1)</strong> using the <strong>OVER8</strong> bit.</p>
</section>
<section id="cr1-control-register-1">
<h2><span class="section-number">4.1.7.5.8. </span>CR1 (Control Register 1)<a class="headerlink" href="#cr1-control-register-1" title="Link to this heading"></a></h2>
<p>The <strong>CR1</strong> register is crucial for configuring basic parameters for USART communication. It controls various essential functionalities for the operation of the USART peripheral, such as enabling or disabling the USART, setting data transfer speeds, and enabling data reception and transmission.</p>
<p><strong>Key Bits in CR1</strong>:</p>
<ol class="arabic simple">
<li><p><strong>UE (USART Enable)</strong>:
- <strong>Function</strong>: Enables or disables the USART peripheral.
- <strong>When set</strong>: The USART peripheral is activated and functional, meaning it can transmit and receive data.
- <strong>When not set</strong>: The USART is disabled, and no data transmission or reception is possible.</p></li>
<li><p><strong>TE (Transmitter Enable)</strong>:
- <strong>Function</strong>: Enables or disables data transmission through the USART.
- <strong>When set</strong>: The device is ready to transmit data on the TX pin.
- <strong>When not set</strong>: The USART will not transmit data.</p></li>
<li><p><strong>RE (Receiver Enable)</strong>:
- <strong>Function</strong>: Enables or disables data reception through the USART.
- <strong>When set</strong>: The device is ready to receive data on the RX pin.
- <strong>When not set</strong>: The USART will not receive data.</p></li>
</ol>
<p>These three bits—<strong>UE</strong>, <strong>TE</strong>, and <strong>RE</strong>—are fundamental for controlling the communication process over USART. Without enabling the USART (<strong>UE</strong>), the device cannot function. Likewise, without enabling the transmitter (<strong>TE</strong>) and receiver (<strong>RE</strong>), the device cannot send or receive data, respectively.</p>
</section>
<section id="usart-cr1-over8-oversampling-mode">
<h2><span class="section-number">4.1.7.5.9. </span>USART_CR1_OVER8 (Oversampling Mode)<a class="headerlink" href="#usart-cr1-over8-oversampling-mode" title="Link to this heading"></a></h2>
<p>The <strong>OVER8</strong> bit in the <strong>CR1</strong> register controls the oversampling mode used for receiving data.</p>
<ul class="simple">
<li><p><strong>Function</strong>: Oversampling refers to taking multiple samples of the data during a single bit cycle to improve the accuracy of the received data.</p></li>
<li><p><strong>Values</strong>:
- <strong>OVER8 = 0</strong>: Sets 16x oversampling mode, which provides more accuracy in data reception.
- <strong>OVER8 = 1</strong>: Sets 8x oversampling mode, which allows faster data transmission but may reduce accuracy.</p></li>
</ul>
<p>In summary, <strong>CR1</strong> is crucial for enabling the USART peripheral, managing transmission and reception functionality, and adjusting the oversampling mode for accuracy and speed.</p>
</section>
<section id="data-reception">
<h2><span class="section-number">4.1.7.5.10. </span>Data Reception<a class="headerlink" href="#data-reception" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Check if data is received</strong>: Before reading data, check if a byte is available in the USART Data Register (<strong>USART_DR</strong>). This check is performed through the <strong>RXNE</strong> (Read Data Register Not Empty) bit in the <strong>USART_SR</strong> (Status Register). If this bit is set to 1, the data is ready to be read.</p></li>
<li><p><strong>Reading Data</strong>: When data is ready (<strong>RXNE = 1</strong>), the value is read from the <strong>USART_DR</strong> register. This register holds the last received byte of data.</p></li>
</ul>
</section>
<section id="data-transmission">
<h2><span class="section-number">4.1.7.5.11. </span>Data Transmission<a class="headerlink" href="#data-transmission" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>Check if the register is empty</strong>: Before sending data, check if the <strong>Transmit Data Register (TDR)</strong> is empty and ready for a new byte to transmit. This check is done through the <strong>TXE</strong> (Transmit Data Register Empty) bit in the <strong>USART_SR</strong> register. If this bit is set to 1, the register is empty and a new byte can be sent.</p></li>
<li><p><strong>Sending Data</strong>: When the register is empty, the byte to be transmitted is written to the <strong>USART_DR</strong> register. This register is responsible for transmitting data via USART.</p></li>
<li><p><strong>Waiting for transmission to complete</strong>: After the byte is written to <strong>USART_DR</strong>, wait for the transmission to complete. This is checked using the <strong>TC</strong> (Transmission Complete) bit in the <strong>USART_SR</strong> register. If <strong>TC = 1</strong>, the byte has been successfully sent, and the transmission is complete.</p></li>
</ul>
</section>
<section id="usart-communication-initialization-process">
<h2><span class="section-number">4.1.7.5.12. </span>USART Communication Initialization Process<a class="headerlink" href="#usart-communication-initialization-process" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Disable USART before configuration</strong>: First, disable USART to avoid issues with settings during configuration. This ensures safe register settings without accidentally starting communication before proper setup. Set the <strong>USART_CR1_UE</strong> value to 0.</p></li>
<li><p><strong>Pin Configuration</strong>: After disabling USART, set the appropriate pins for communication. This involves assigning pins for data reception (RX) and data transmission (TX). These pins must be correctly connected to the physical ports of the microcontroller.</p></li>
<li><p><strong>Setting Oversampling and Baudrate</strong>: Next, set the parameters for data transmission speed (baudrate) and oversampling mode (sampling rate during one bit cycle).</p></li>
<li><p><strong>Set Operating Mode (RX/TX)</strong>: Based on the selected mode (receive-only, transmit-only, or both), activate the corresponding device (receiver or transmitter).</p></li>
<li><p><strong>Re-enable USART</strong>: Once all parameters are set, re-enable USART to begin communication.</p></li>
</ol>
</section>
<section id="connecting-a-serial-monitor-to-the-mcu">
<h2><span class="section-number">4.1.7.5.13. </span>Connecting a Serial Monitor to the MCU<a class="headerlink" href="#connecting-a-serial-monitor-to-the-mcu" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Selecting Pins</strong>: First, choose the appropriate pins for <strong>TX</strong> (data transmission) and <strong>RX</strong> (data reception) on the microcontroller. For example, the <strong>TX</strong> pin on the microcontroller is connected to the <strong>RX</strong> pin of the serial monitor (or computer), and the <strong>RX</strong> pin of the microcontroller is connected to the <strong>TX</strong> pin of the monitor.</p></li>
<li><p><strong>Pin Configuration</strong>: The pins on the microcontroller must be configured as alternate functions to enable communication via USART. These pins allow data transmission and reception between the microcontroller and the computer.</p></li>
<li><p><strong>Selecting Baudrate</strong>: Set the desired data transmission speed (<strong>baudrate</strong>), which must match on both the microcontroller and the serial monitor. Standard baud rates for serial communication include 9600, 115200, etc.</p></li>
<li><p><strong>Setting the Operating Mode</strong>: Set the microcontroller to <strong>TX/RX</strong> mode (transmit and receive), ensuring both pins (TX and RX) are active and able to exchange data.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Clock.html" class="btn btn-neutral float-left" title="4.1.7.4. Clock" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Timer.html" class="btn btn-neutral float-right" title="4.1.7.6. Timer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Maasu BH d.o.o..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>